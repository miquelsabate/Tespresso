<%= render 'layouts/header' %>

<body>

  <div class="container-fluid" style="text-align:center;">
    <h2>Su cesta</h2>
  </div>
  <br>
  <div class="container-fluid" style="text-align:center;">
        <% @orders.each do |t| %>
        <% if t.state == "Carrito" %>
        <% total = 0 %>
          <table class="table table-striped table-dark">
          <thead>
            <th scope="col">
              <span class="align-middle">Order ID: <%= t.id %>&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp; Estado: <%= t.state %></span>
            </th>
            <th scope="col"</th>
            <th scope="col">
                <button class="btn btn-warning" role="button" href="#">Proceder al pago</button>
            </th>
          </thead>
          <thead>
            <tr>
              <th scope="col">Nombre de producto</th>
              <th scope="col">Precio de producto</th>
              <th scope="col">Fecha de creación</th>
            </tr>
          </thead>
          <tbody>
          <% t.order_items.each do |i| %>
          <tr>
            <td><%= @products[i.product_id].name %></td>
            <td><%= @products[i.product_id].price %> €</td>
            <% price = @products[i.product_id].price %>
            <% total += price %>
            <td><%= t.created_at %></td>
          </tr>
          <% end %>
          <tr>
            <td></td>
            <td></td>
            <td><b>PRECIO TOTAL: &nbsp;&nbsp;&nbsp;<%= (total* 1000).floor / 1000.0 %> €</b></td>
          </tr>
          <% end %>
        </tbody>

      </table>
        <% end %>
  </div>

  <%= render 'layouts/footer' %>

</body>
